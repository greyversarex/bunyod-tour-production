<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="transfer_page_title">–¢—Ä–∞–Ω—Å—Ñ–µ—Ä - Bunyod-Tour</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- üåê –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –ò–ù–¢–ï–†–ù–ê–¶–ò–û–ù–ê–õ–ò–ó–ê–¶–ò–ò -->
    <script defer src="/public/js/i18n.js?v=1.6"></script>
    <script src="/public/js/booking-state.js"></script>
    <script defer src="/public/js/layout-loader.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Noto Sans', 'Ubuntu', 'Cantarell', 'Helvetica Neue', sans-serif; }
        
        
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–∏—Ö –º–µ–Ω—é */
        .dropdown {
            position: relative;
            display: inline-block;
        }
        
        .dropdown-submenu {
            position: relative;
        }
        
        .dropdown-subcontent {
            display: none;
            position: absolute;
            background-color: #3E3E3E;
            min-width: 300px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1002;
            border-radius: 8px;
            padding: 8px;
            top: 0;
            left: 100%;
        }
        
        .dropdown-submenu:hover .dropdown-subcontent {
            display: block;
        }
        
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #3E3E3E;
            min-width: 200px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1001;
            border-radius: 8px;
            padding: 8px 0;
            top: 100%;
            left: 0;
        }
        
        .dropdown-content a {
            color: white !important;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            transition: background-color 0.3s ease;
        }
        
        .dropdown-content a:hover {
            background-color: #4A4A4A;
            border-radius: 4px;
            margin: 0 4px;
        }
        
        .dropdown:hover .dropdown-content {
            display: block;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—É—Å–µ–ª–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π */
        #vehicleCarousel::-webkit-scrollbar {
            height: 8px;
        }
        #vehicleCarousel::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        #vehicleCarousel::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        #vehicleCarousel::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        .vehicle-carousel-card {
            min-width: 280px;
            max-width: 280px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
            scroll-snap-align: start;
        }
        .vehicle-carousel-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            border-color: #3E3E3E;
        }
        .vehicle-carousel-card.selected {
            border-color: #3E3E3E;
            box-shadow: 0 0 0 3px rgba(62, 62, 62, 0.2);
        }
        .vehicle-carousel-img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }
    </style>
</head>
<body class="bg-gray-50">

    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è header -->
    <div id="header-container"></div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="bg-gray-50 py-12">
        <div class="max-w-4xl mx-auto px-6">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
            <div class="text-center mb-12">
                <h1 class="text-4xl font-bold text-gray-900 mb-4" data-i18n="transfer_main_title">–¢—Ä–∞–Ω—Å—Ñ–µ—Ä</h1>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto" data-i18n="transfer_main_subtitle">
                    –ó–∞–∫–∞–∂–∏—Ç–µ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä –∫—É–¥–∞ –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ. –ë—ã—Å—Ç—Ä–æ, —É–¥–æ–±–Ω–æ –∏ –Ω–∞–¥–µ–∂–Ω–æ.
                </p>
            </div>

            <!-- –§–æ—Ä–º–∞ –∑–∞—è–≤–∫–∏ –Ω–∞ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä -->
            <div class="bg-white rounded-xl shadow-lg p-8 mb-12">
                <div class="mb-6">
                    <h2 class="text-2xl font-semibold text-gray-900 mb-2" data-i18n="transfer_form_title">–ó–∞–∫–∞–∑–∞—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä</h2>
                    <p class="text-gray-600" data-i18n="transfer_form_subtitle">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –∏ –º—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è</p>
                </div>

                <form id="transferForm" class="space-y-6">
                    <!-- –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="fullName" class="block text-sm font-medium text-gray-700 mb-2">
                                <span data-i18n="transfer_fullname">–§–ò–û</span> <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="fullName" name="fullName" required 
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                data-i18n-placeholder="transfer_fullname_placeholder"
                                placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –ø–æ–ª–Ω–æ–µ –∏–º—è">
                        </div>
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700 mb-2" data-i18n="transfer_email">
                                Email
                            </label>
                            <input type="email" id="email" name="email" 
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                data-i18n-placeholder="transfer_email_placeholder"
                                placeholder="your@email.com">
                        </div>
                    </div>

                    <div>
                        <label for="phone" class="block text-sm font-medium text-gray-700 mb-2" data-i18n="transfer_phone">
                            –¢–µ–ª–µ—Ñ–æ–Ω
                        </label>
                        <input type="tel" id="phone" name="phone" 
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            data-i18n-placeholder="transfer_phone_placeholder"
                            placeholder="+992 XX XXX XXXX">
                    </div>

                    <!-- –í—ã–±–æ—Ä —Å—Ç—Ä–∞–Ω—ã –∏ –≥–æ—Ä–æ–¥–∞ -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="transferCountry" class="block text-sm font-medium text-gray-700 mb-2" data-i18n="transfer_country">
                                –°—Ç—Ä–∞–Ω–∞
                            </label>
                            <select id="transferCountry" name="transferCountry" 
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="" data-i18n="transfer_country_select">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É</option>
                            </select>
                        </div>
                        <div>
                            <label for="transferCity" class="block text-sm font-medium text-gray-700 mb-2" data-i18n="transfer_city">
                                –ì–æ—Ä–æ–¥
                            </label>
                            <select id="transferCity" name="transferCity" 
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="" data-i18n="transfer_city_select">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</option>
                            </select>
                        </div>
                    </div>

                    <!-- –î–µ—Ç–∞–ª–∏ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∞ -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="pickupLocation" class="block text-sm font-medium text-gray-700 mb-2">
                                <span data-i18n="transfer_pickup">–ú–µ—Å—Ç–æ –ø—Ä–∏—ë–º–∞</span> <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="pickupLocation" name="pickupLocation" required 
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                data-i18n-placeholder="transfer_pickup_placeholder"
                                placeholder="–û—Ç–∫—É–¥–∞ –∑–∞–±—Ä–∞—Ç—å (–∞–¥—Ä–µ—Å, –æ—Ç–µ–ª—å, –∞—ç—Ä–æ–ø–æ—Ä—Ç)">
                        </div>
                        <div>
                            <label for="dropoffLocation" class="block text-sm font-medium text-gray-700 mb-2">
                                <span data-i18n="transfer_dropoff">–ú–µ—Å—Ç–æ –≤—ã—Å–∞–¥–∫–∏</span> <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="dropoffLocation" name="dropoffLocation" required 
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                data-i18n-placeholder="transfer_dropoff_placeholder"
                                placeholder="–ö—É–¥–∞ –¥–æ—Å—Ç–∞–≤–∏—Ç—å (–∞–¥—Ä–µ—Å, –æ—Ç–µ–ª—å)">
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <label for="pickupDate" class="block text-sm font-medium text-gray-700 mb-2">
                                <span data-i18n="transfer_date">–î–∞—Ç–∞</span> <span class="text-red-500">*</span>
                            </label>
                            <input type="date" id="pickupDate" name="pickupDate" required 
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div>
                            <label for="pickupTime" class="block text-sm font-medium text-gray-700 mb-2">
                                <span data-i18n="transfer_time">–í—Ä–µ–º—è</span> <span class="text-red-500">*</span>
                            </label>
                            <input type="time" id="pickupTime" name="pickupTime" required 
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div>
                            <label for="numberOfPeople" class="block text-sm font-medium text-gray-700 mb-2" data-i18n="transfer_passengers">
                                –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤
                            </label>
                            <input type="number" id="numberOfPeople" name="numberOfPeople" min="1" max="8" value="1"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>

                    <!-- –§–∏–ª—å—Ç—Ä—ã –≤—ã–±–æ—Ä–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-3" data-i18n="transfer_vehicle_filters">
                            –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ–º–æ–±–∏–ª—è
                        </label>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg border border-gray-200">
                            <div>
                                <label for="vehicleType" class="block text-xs font-medium text-gray-600 mb-2" data-i18n="transfer_vehicle_type">
                                    –¢–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
                                </label>
                                <select id="vehicleType" name="vehicleType" 
                                    class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="" data-i18n="transfer_vehicle_select">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                                    <option value="sedan" data-i18n="transfer_vehicle_sedan">–°–µ–¥–∞–Ω</option>
                                    <option value="suv" data-i18n="transfer_vehicle_suv">–í–Ω–µ–¥–æ—Ä–æ–∂–Ω–∏–∫</option>
                                    <option value="minibus" data-i18n="transfer_vehicle_minibus">–ú–∏–∫—Ä–æ–∞–≤—Ç–æ–±—É—Å</option>
                                    <option value="bus" data-i18n="transfer_vehicle_bus">–ê–≤—Ç–æ–±—É—Å</option>
                                    <option value="minivan" data-i18n="transfer_vehicle_minivan">–ú–∏–Ω–∏–≤—ç–Ω</option>
                                    <option value="luxury" data-i18n="transfer_vehicle_luxury">–õ—é–∫—Å</option>
                                </select>
                            </div>
                            <div>
                                <label for="vehicleCapacity" class="block text-xs font-medium text-gray-600 mb-2" data-i18n="transfer_vehicle_capacity">
                                    –í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
                                </label>
                                <select id="vehicleCapacity" name="vehicleCapacity" 
                                    class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                    <option value="" data-i18n="transfer_capacity_any">–õ—é–±–∞—è</option>
                                    <option value="1-4" data-i18n="transfer_capacity_1_4">1-4 –ø–∞—Å—Å–∞–∂–∏—Ä–∞</option>
                                    <option value="5-8" data-i18n="transfer_capacity_5_8">5-8 –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤</option>
                                    <option value="9-15" data-i18n="transfer_capacity_9_15">9-15 –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤</option>
                                    <option value="16+" data-i18n="transfer_capacity_16_plus">16+ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- –ö–∞—Ä—É—Å–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π -->
                    <div id="vehicleCarouselSection" class="hidden">
                        <label class="block text-sm font-medium text-gray-700 mb-3" data-i18n="transfer_available_vehicles">
                            –î–æ—Å—Ç—É–ø–Ω—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏
                        </label>
                        <div class="relative">
                            <div id="vehicleCarousel" class="flex overflow-x-auto gap-4 pb-4 snap-x snap-mandatory scroll-smooth" style="scrollbar-width: thin;">
                                <!-- –ê–≤—Ç–æ–º–æ–±–∏–ª–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                            </div>
                            <div id="noVehiclesMessage" class="hidden text-center py-8 text-gray-500">
                                <i class="fas fa-car text-4xl mb-3"></i>
                                <p data-i18n="transfer_no_vehicles">–ê–≤—Ç–æ–º–æ–±–∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞.</p>
                            </div>
                        </div>
                    </div>

                    <div>
                        <label for="specialRequests" class="block text-sm font-medium text-gray-700 mb-2" data-i18n="transfer_special_requests">
                            –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è
                        </label>
                        <textarea id="specialRequests" name="specialRequests" rows="3"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            data-i18n-placeholder="transfer_special_requests_placeholder"
                            placeholder="–î–µ—Ç—Å–∫–æ–µ –∞–≤—Ç–æ–∫—Ä–µ—Å–ª–æ, –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ –ø—É—Ç–∏, –æ—Å–æ–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è..."></textarea>
                    </div>

                    <!-- –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
                    <div class="pt-4">
                        <button type="submit" id="submitBtn"
                            class="w-full text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2" style="background: #6B7280;">
                            <span id="submitText" data-i18n="transfer_submit_btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</span>
                            <span id="loadingText" class="hidden">
                                <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                </svg>
                                <span data-i18n="transfer_submit_sending">–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è...</span>
                            </span>
                        </button>
                    </div>
                </form>

                <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
                <div id="notification" class="hidden mt-6 p-4 rounded-lg">
                    <div id="notificationContent"></div>
                </div>
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞—Ç–∞–ª–æ–≥–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ -->
            <div class="rounded-xl shadow-lg p-8 text-center" style="background: linear-gradient(135deg, #3E3E3E 0%, #2F2F2F 100%);">
                <div class="mb-6">
                    <i class="fas fa-car text-white text-5xl mb-4"></i>
                    <h2 class="text-2xl font-bold text-white mb-3" data-i18n="transfer.catalog_info_title">
                        –û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –Ω–∞—à–∏–º –∞–≤—Ç–æ–ø–∞—Ä–∫–æ–º
                    </h2>
                    <p class="text-white/90 max-w-2xl mx-auto text-lg" data-i18n="transfer.catalog_info_text">
                        –•–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ –Ω–∞—à–µ–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–µ? –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–æ–ª–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏, –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ –∏ —Ü–µ–Ω–∞–º–∏ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π.
                    </p>
                </div>
                
                <a href="/vehicles-catalog.html" 
                   class="inline-block bg-white text-gray-900 font-semibold py-4 px-8 rounded-lg transition-all duration-200 hover:bg-gray-100 hover:scale-105 shadow-lg">
                    <i class="fas fa-list-ul mr-2"></i>
                    <span data-i18n="transfer.view_catalog_btn">–°–º–æ—Ç—Ä–µ—Ç—å –∫–∞—Ç–∞–ª–æ–≥ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞</span>
                </a>
            </div>

        </div>
    </main>


    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è footer -->
    <div id="footer-container"></div>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —è–∑—ã–∫–æ–≤–æ–≥–æ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ –º–µ–Ω—é
        function toggleLanguageDropdown() {
            const dropdown = document.getElementById('langDropdown');
            const langDropdown = document.querySelector('.language-dropdown');
            
            if (dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
                langDropdown.classList.remove('active');
            } else {
                dropdown.classList.add('show');
                langDropdown.classList.add('active');
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞
        function selectLanguage(langCode, flagClass, langName) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —è–∑—ã–∫ –≤ –∫–Ω–æ–ø–∫–µ
            document.querySelector('.selected-flag').className = `selected-flag ${flagClass}`;
            document.querySelector('.selected-lang').textContent = langName;
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –æ–ø—Ü–∏–π
            document.querySelectorAll('.lang-option').forEach(option => {
                option.classList.remove('active');
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –æ–ø—Ü–∏–∏
            document.querySelector(`[data-lang="${langCode}"]`).classList.add('active');
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫
            toggleLanguageDropdown();
            
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è —Å–º–µ–Ω—ã —è–∑—ã–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            console.log('Selected language:', langCode);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∞–ª—é—Ç–Ω–æ–≥–æ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ –º–µ–Ω—é
        function toggleCurrencyDropdown() {
            const dropdown = document.getElementById('currencyDropdown');
            const currencyDropdown = dropdown.parentElement;
            
            if (dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
                currencyDropdown.classList.remove('active');
            } else {
                dropdown.classList.add('show');
                currencyDropdown.classList.add('active');
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤–∞–ª—é—Ç—ã
        function selectCurrency(currencyCode, currencyName) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∞–ª—é—Ç—É –≤ –∫–Ω–æ–ø–∫–µ
            document.querySelector('.selected-currency').textContent = currencyName;
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –æ–ø—Ü–∏–π
            document.querySelectorAll('#currencyDropdown .lang-option').forEach(option => {
                option.classList.remove('active');
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –æ–ø—Ü–∏–∏
            document.querySelector(`[data-currency="${currencyCode}"]`).classList.add('active');
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫
            toggleCurrencyDropdown();
            
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è —Å–º–µ–Ω—ã –≤–∞–ª—é—Ç—ã
            console.log('Selected currency:', currencyCode);
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –≤—ã–ø–∞–¥–∞—é—â–∏—Ö –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
        document.addEventListener('click', function(event) {
            const langDropdown = document.querySelector('.language-dropdown');
            const langDropdownContent = document.getElementById('langDropdown');
            const currencyDropdowns = document.querySelectorAll('.language-dropdown');
            const currencyDropdownContent = document.getElementById('currencyDropdown');
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ —è–∑—ã–∫–æ–≤–æ–≥–æ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞
            if (!langDropdown.contains(event.target)) {
                langDropdownContent.classList.remove('show');
                langDropdown.classList.remove('active');
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –≤–∞–ª—é—Ç–Ω–æ–≥–æ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞
            currencyDropdowns.forEach(dropdown => {
                if (dropdown.contains(currencyDropdownContent) && !dropdown.contains(event.target)) {
                    currencyDropdownContent.classList.remove('show');
                    dropdown.classList.remove('active');
                }
            });
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∞
        document.addEventListener('DOMContentLoaded', function() {
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
            const today = new Date().toISOString().split('T')[0];
            const pickupDateInput = document.getElementById('pickupDate');
            if (pickupDateInput) {
                pickupDateInput.min = today;
                console.log('Transfer form initialized, min date set to:', today);
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
            const transferForm = document.getElementById('transferForm');
            if (transferForm) {
                transferForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const submitBtn = document.getElementById('submitBtn');
                    const submitText = document.getElementById('submitText');
                    const loadingText = document.getElementById('loadingText');
                    const notification = document.getElementById('notification');
                    const notificationContent = document.getElementById('notificationContent');
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
                    submitBtn.disabled = true;
                    submitText.classList.add('hidden');
                    loadingText.classList.remove('hidden');
                    notification.classList.add('hidden');
                    
                    try {
                        // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
                        const formData = new FormData(this);
                        // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                        const email = formData.get('email')?.trim();
                        const phone = formData.get('phone')?.trim();
                        if (!email && !phone) {
                            const errorTitle = window.translations?.['transfer_error_validation']?.[window.currentLanguage] || '–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏';
                            const errorMessage = window.translations?.['transfer_error_contact']?.[window.currentLanguage] || '–£–∫–∞–∂–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Å–ø–æ—Å–æ–± —Å–≤—è–∑–∏: email –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω';
                            notificationContent.innerHTML = `
                                <div class="flex items-center">
                                    <svg class="w-6 h-6 text-red-600 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                    <div>
                                        <h4 class="font-semibold text-red-800">${errorTitle}</h4>
                                        <p class="text-red-600">${errorMessage}</p>
                                    </div>
                                </div>
                            `;
                            notification.classList.remove('hidden');
                            notification.classList.add('bg-red-50', 'border', 'border-red-200');
                            return;
                        }
                        
                        const data = {
                            fullName: formData.get('fullName'),
                            email: email || undefined,
                            phone: phone || undefined,
                            countryId: formData.get('transferCountry') ? parseInt(formData.get('transferCountry')) : undefined,
                            cityId: formData.get('transferCity') ? parseInt(formData.get('transferCity')) : undefined,
                            pickupLocation: formData.get('pickupLocation'),
                            dropoffLocation: formData.get('dropoffLocation'),
                            pickupTime: formData.get('pickupTime'),
                            pickupDate: formData.get('pickupDate'),
                            numberOfPeople: parseInt(formData.get('numberOfPeople')) || 1,
                            vehicleType: formData.get('vehicleType') || undefined,
                            vehicleCapacity: formData.get('vehicleCapacity') || undefined,
                            vehicleId: selectedVehicleId || undefined,
                            specialRequests: formData.get('specialRequests') || undefined
                        };
                        
                        console.log('–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–∫–∏ –Ω–∞ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä:', data);
                        
                        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
                        const response = await fetch('/api/transfer-requests', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(data)
                        });
                        
                        const result = await response.json();
                        console.log('–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', result);
                        
                        if (result.success) {
                            // üöó –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∞ –≤ booking state –¥–ª—è –æ–ø–ª–∞—Ç—ã
                            const selectedVehicle = allVehicles.find(v => v.id === selectedVehicleId);
                            const vehiclePrice = selectedVehicle?.pricePerDay || 0;
                            const currency = selectedVehicle?.currency || window.selectedCurrency || 'TJS';
                            
                            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º booking state
                            bookingStateManager.init();
                            
                            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã bookingStateManager –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                            bookingStateManager.setBookingId(result.data?.id || null);
                            
                            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∏–ø –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞–∫ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä
                            bookingStateManager.state.bookingType = 'transfer';
                            
                            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ
                            bookingStateManager.state.transfer = {
                                id: result.data?.id,
                                vehicleId: selectedVehicleId,
                                vehicleName: selectedVehicle ? (window.currentLanguage === 'ru' ? selectedVehicle.nameRu : selectedVehicle.nameEn) : '',
                                countryId: parseInt(formData.get('transferCountry')),
                                cityId: parseInt(formData.get('transferCity')),
                                pickupLocation: formData.get('pickupLocation'),
                                dropoffLocation: formData.get('dropoffLocation'),
                                pickupDate: formData.get('pickupDate'),
                                pickupTime: formData.get('pickupTime'),
                                numberOfPeople: parseInt(formData.get('numberOfPeople')) || 1,
                                specialRequests: formData.get('specialRequests') || ''
                            };
                            
                            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                            bookingStateManager.setContact({
                                name: formData.get('fullName'),
                                phone: phone,
                                email: email
                            });
                            
                            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–µ–Ω—ã
                            bookingStateManager.state.pricing.tourBasePrice = 0;
                            bookingStateManager.state.pricing.transferPrice = vehiclePrice;
                            bookingStateManager.state.pricing.roomSurcharge = 0;
                            bookingStateManager.state.pricing.mealSurcharge = 0;
                            bookingStateManager.state.pricing.grandTotal = vehiclePrice;
                            bookingStateManager.state.pricing.currency = currency;
                            
                            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —è–∑—ã–∫ –∏ –≤–∞–ª—é—Ç—É
                            bookingStateManager.setLanguage(window.currentLanguage || 'ru');
                            bookingStateManager.setSelectedCurrency(currency);
                            
                            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ sessionStorage
                            bookingStateManager.persist();
                            console.log('‚úÖ Transfer data saved to booking state:', bookingStateManager.state);
                            
                            // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∞
                            window.location.href = '/transfer-payment.html';
                            
                        } else {
                            // –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞
                            const errorTitle = window.translations?.['transfer_error_title']?.[window.currentLanguage] || '–û—à–∏–±–∫–∞';
                            const errorDefault = window.translations?.['transfer_error_message']?.[window.currentLanguage] || '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞—è–≤–∫–∏';
                            notificationContent.innerHTML = `
                                <div class="flex items-center">
                                    <svg class="w-6 h-6 text-red-600 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                    <div>
                                        <h4 class="font-semibold text-red-800">${errorTitle}</h4>
                                        <p class="text-red-600">${result.error || errorDefault}</p>
                                    </div>
                                </div>
                            `;
                            notification.classList.remove('hidden');
                            notification.classList.add('bg-red-50', 'border', 'border-red-200');
                            notification.classList.remove('bg-green-50', 'border-green-200');
                        }
                        
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞—è–≤–∫–∏:', error);
                        notificationContent.innerHTML = `
                            <div class="flex items-center">
                                <svg class="w-6 h-6 text-red-600 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                                <div>
                                    <h4 class="font-semibold text-red-800">–û—à–∏–±–∫–∞ —Å–µ—Ç–∏</h4>
                                    <p class="text-red-600">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞</p>
                                </div>
                            </div>
                        `;
                        notification.classList.remove('hidden');
                        notification.classList.add('bg-red-50', 'border', 'border-red-200');
                        notification.classList.remove('bg-green-50', 'border-green-200');
                    } finally {
                        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–Ω–æ–ø–∫—É –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                        submitBtn.disabled = false;
                        submitText.classList.remove('hidden');
                        loadingText.classList.add('hidden');
                    }
                });
            }

            // === –ù–û–í–´–ô –ö–û–î: –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω, –≥–æ—Ä–æ–¥–æ–≤ –∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π ===
            let allCountries = [];
            let allCities = [];
            let allVehicles = [];
            let selectedVehicleId = null;

            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω
            async function loadCountries() {
                try {
                    console.log('üìç –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ —Å—Ç—Ä–∞–Ω...');
                    const response = await fetch('/api/countries');
                    const data = await response.json();
                    console.log('‚úÖ –°—Ç—Ä–∞–Ω—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', data.data.length);
                    if (data.success) {
                        allCountries = data.data;
                        populateCountrySelect();
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω:', error);
                }
            }

            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ select —Å—Ç—Ä–∞–Ω
            function populateCountrySelect() {
                const countrySelect = document.getElementById('transferCountry');
                console.log('üìç populateCountrySelect() –≤—ã–∑–≤–∞–Ω, —ç–ª–µ–º–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω:', !!countrySelect);
                if (!countrySelect) {
                    console.error('‚ùå –≠–ª–µ–º–µ–Ω—Ç transferCountry –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                    return;
                }
                
                const lang = window.currentLanguage || 'ru';
                console.log('üåç –¢–µ–∫—É—â–∏–π —è–∑—ã–∫:', lang, '–°—Ç—Ä–∞–Ω –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:', allCountries.length);
                countrySelect.innerHTML = '<option value="" data-i18n="transfer_country_select">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É</option>';
                
                allCountries.forEach((country, index) => {
                    const option = document.createElement('option');
                    option.value = country.id;
                    option.textContent = lang === 'ru' ? country.nameRu : country.nameEn;
                    countrySelect.appendChild(option);
                    console.log(`  ‚úì –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä–∞–Ω–∞ #${index + 1}:`, option.textContent, '(ID:', country.id + ')');
                });
                console.log('‚úÖ –í—Å–µ–≥–æ –æ–ø—Ü–∏–π –≤ select:', countrySelect.options.length);
            }

            // –ó–∞–≥—Ä—É–∑–∫–∞ –≥–æ—Ä–æ–¥–æ–≤
            async function loadCities() {
                try {
                    console.log('üèôÔ∏è –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –≥–æ—Ä–æ–¥–æ–≤...');
                    const response = await fetch('/api/cities');
                    const data = await response.json();
                    console.log('‚úÖ –ì–æ—Ä–æ–¥–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', data.data.length);
                    if (data.success) {
                        allCities = data.data;
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–æ—Ä–æ–¥–æ–≤:', error);
                }
            }

            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ select –≥–æ—Ä–æ–¥–æ–≤ (—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –ø–æ —Å—Ç—Ä–∞–Ω–µ)
            function populateCitySelect(countryId = null) {
                const citySelect = document.getElementById('transferCity');
                console.log('üèôÔ∏è populateCitySelect() –≤—ã–∑–≤–∞–Ω, countryId:', countryId, '—ç–ª–µ–º–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω:', !!citySelect);
                if (!citySelect) {
                    console.error('‚ùå –≠–ª–µ–º–µ–Ω—Ç transferCity –Ω–µ –Ω–∞–π–¥–µ–Ω!');
                    return;
                }
                
                const lang = window.currentLanguage || 'ru';
                console.log('üåç –¢–µ–∫—É—â–∏–π —è–∑—ã–∫:', lang, '–í—Å–µ–≥–æ –≥–æ—Ä–æ–¥–æ–≤:', allCities.length);
                citySelect.innerHTML = '<option value="" data-i18n="transfer_city_select">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</option>';
                
                const filteredCities = countryId 
                    ? allCities.filter(city => city.countryId == countryId)
                    : allCities;
                
                console.log('üîç –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ –≥–æ—Ä–æ–¥–æ–≤:', filteredCities.length, '–¥–ª—è —Å—Ç—Ä–∞–Ω—ã ID:', countryId || '–≤—Å–µ');
                
                filteredCities.forEach((city, index) => {
                    const option = document.createElement('option');
                    option.value = city.id;
                    option.textContent = lang === 'ru' ? city.nameRu : city.nameEn;
                    citySelect.appendChild(option);
                    console.log(`  ‚úì –î–æ–±–∞–≤–ª–µ–Ω –≥–æ—Ä–æ–¥ #${index + 1}:`, option.textContent, '(ID:', city.id, 'CountryID:', city.countryId + ')');
                });
                console.log('‚úÖ –í—Å–µ–≥–æ –æ–ø—Ü–∏–π –≥–æ—Ä–æ–¥–æ–≤ –≤ select:', citySelect.options.length);
            }

            // –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
            async function loadVehicles() {
                try {
                    const lang = window.currentLanguage || 'ru';
                    console.log('üöó –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π...');
                    const response = await fetch(`/api/vehicles?lang=${lang}`);
                    const data = await response.json();
                    console.log('‚úÖ –ê–≤—Ç–æ–º–æ–±–∏–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', data.data.length);
                    if (data.success) {
                        allVehicles = data.data.filter(v => v.isActive);
                        console.log('üîß –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π, –∞–∫—Ç–∏–≤–Ω—ã—Ö:', allVehicles.length);
                        applyVehicleFilters();
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π:', error);
                }
            }

            // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∫ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º
            function applyVehicleFilters() {
                const country = document.getElementById('transferCountry')?.value || '';
                const city = document.getElementById('transferCity')?.value || '';
                const type = document.getElementById('vehicleType')?.value || '';
                const capacity = document.getElementById('vehicleCapacity')?.value || '';
                
                let filtered = allVehicles.filter(vehicle => {
                    if (country && vehicle.countryId != country) return false;
                    if (city && vehicle.cityId != city) return false;
                    if (type && vehicle.type.toLowerCase() !== type.toLowerCase()) return false;
                    
                    if (capacity) {
                        const cap = vehicle.capacity;
                        if (capacity === '1-4' && (cap < 1 || cap > 4)) return false;
                        if (capacity === '5-8' && (cap < 5 || cap > 8)) return false;
                        if (capacity === '9-15' && (cap < 9 || cap > 15)) return false;
                        if (capacity === '16+' && cap < 16) return false;
                    }
                    
                    return true;
                });
                
                renderVehicleCarousel(filtered);
            }

            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ä—É—Å–µ–ª–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
            function renderVehicleCarousel(vehicles) {
                const carousel = document.getElementById('vehicleCarousel');
                const carouselSection = document.getElementById('vehicleCarouselSection');
                const noVehiclesMessage = document.getElementById('noVehiclesMessage');
                
                if (!carousel || !carouselSection) return;
                
                carousel.innerHTML = '';
                
                if (vehicles.length === 0) {
                    carouselSection.classList.add('hidden');
                    noVehiclesMessage?.classList.remove('hidden');
                    return;
                }
                
                carouselSection.classList.remove('hidden');
                noVehiclesMessage?.classList.add('hidden');
                
                const lang = window.currentLanguage || 'ru';
                
                vehicles.forEach(vehicle => {
                    const card = createVehicleCarouselCard(vehicle, lang);
                    carousel.appendChild(card);
                });
            }

            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –¥–ª—è –∫–∞—Ä—É—Å–µ–ª–∏
            function createVehicleCarouselCard(vehicle, lang) {
                const card = document.createElement('div');
                card.className = 'vehicle-carousel-card';
                if (selectedVehicleId === vehicle.id) {
                    card.classList.add('selected');
                }
                
                // –ü–∞—Ä—Å–∏–Ω–≥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
                let vehicleImages = [];
                if (vehicle.images) {
                    try {
                        const images = typeof vehicle.images === 'string' ? JSON.parse(vehicle.images) : vehicle.images;
                        if (Array.isArray(images) && images.length > 0) {
                            vehicleImages = images.map(img => {
                                if (img.startsWith('http') || img.startsWith('/')) return img;
                                return `/uploads/vehicles/${img}`;
                            });
                        }
                    } catch (e) {
                        console.error('Error parsing vehicle images:', e);
                    }
                }
                
                if (vehicleImages.length === 0) {
                    vehicleImages = ['/api/placeholder/400/200'];
                }
                
                const name = lang === 'ru' ? vehicle.nameRu : vehicle.nameEn;
                const typeKey = `vehicles.type_${vehicle.type.toLowerCase()}`;
                const typeTranslation = window.getTranslation ? window.getTranslation(typeKey, lang) : vehicle.type;
                
                card.innerHTML = `
                    <img src="${vehicleImages[0]}" alt="${name}" class="vehicle-carousel-img" onerror="this.src='/api/placeholder/400/200'">
                    <div class="p-4">
                        <h4 class="font-semibold text-gray-900 mb-1">${name}</h4>
                        <p class="text-sm text-gray-600 mb-2">
                            <i class="fas fa-car mr-1"></i>${typeTranslation}
                        </p>
                        <p class="text-sm text-gray-600">
                            <i class="fas fa-users mr-1"></i>${vehicle.capacity} ${window.getTranslation ? window.getTranslation('vehicles.passengers', lang) : '–ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤'}
                        </p>
                        ${vehicle.pricePerDay ? `
                            <p class="text-sm font-semibold text-gray-900 mt-2">
                                ${vehicle.pricePerDay} ${vehicle.currency || 'TJS'}/${window.getTranslation ? window.getTranslation('vehicles.per_day', lang) : '–¥–µ–Ω—å'}
                            </p>
                        ` : ''}
                    </div>
                `;
                
                card.addEventListener('click', () => selectVehicle(vehicle.id));
                
                return card;
            }

            // –í—ã–±–æ—Ä –∞–≤—Ç–æ–º–æ–±–∏–ª—è
            function selectVehicle(vehicleId) {
                selectedVehicleId = vehicleId;
                document.querySelectorAll('.vehicle-carousel-card').forEach(card => {
                    card.classList.remove('selected');
                });
                event.currentTarget.classList.add('selected');
                console.log('–í—ã–±—Ä–∞–Ω –∞–≤—Ç–æ–º–æ–±–∏–ª—å:', vehicleId);
            }

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
            document.getElementById('transferCountry')?.addEventListener('change', (e) => {
                const countryId = e.target.value;
                populateCitySelect(countryId);
                document.getElementById('transferCity').value = '';
                applyVehicleFilters();
            });

            document.getElementById('transferCity')?.addEventListener('change', applyVehicleFilters);
            document.getElementById('vehicleType')?.addEventListener('change', applyVehicleFilters);
            document.getElementById('vehicleCapacity')?.addEventListener('change', applyVehicleFilters);

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–º–µ–Ω—ã —è–∑—ã–∫–∞ - –æ–±–Ω–æ–≤–ª—è–µ–º —Å–µ–ª–µ–∫—Ç—ã —Å—Ç—Ä–∞–Ω –∏ –≥–æ—Ä–æ–¥–æ–≤
            window.addEventListener('languageChanged', (e) => {
                console.log('üåç –Ø–∑—ã–∫ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞:', e.detail.language, '- –æ–±–Ω–æ–≤–ª—è–µ–º —Å–µ–ª–µ–∫—Ç—ã —Å—Ç—Ä–∞–Ω –∏ –≥–æ—Ä–æ–¥–æ–≤');
                const selectedCountryId = document.getElementById('transferCountry')?.value;
                populateCountrySelect();
                if (selectedCountryId) {
                    document.getElementById('transferCountry').value = selectedCountryId;
                    populateCitySelect(selectedCountryId);
                } else {
                    populateCitySelect();
                }
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–∫–∂–µ –∫–∞—Ä—É—Å–µ–ª—å –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
                loadVehicles();
            });

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            console.log('üöó –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∞: –∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω, –≥–æ—Ä–æ–¥–æ–≤ –∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π...');
            loadCountries();
            loadCities();
            loadVehicles();
        });
    </script>
</body>
</html>